<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Nathan Wood" />
  <title>Installing the StarDist Script</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #000;
      background-color: #f2f4f6;
    }
    body {
      margin: 0 auto;
      max-width: 50%;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  
  
</head>
<body>
<header id="title-block-header">
<h1 class="title">Installing the StarDist Script</h1>
<p class="author">Nathan Wood</p>
</header>
<h1 id="citing-stardist">Citing StarDist</h1>
<p>StarDist github is here: <a
href="https://github.com/stardist/stardist">https://github.com/stardist/stardist</a></p>
<p>StarDist is BSD-3 Licenses software, and it must be cited in any
publication where its use is employed. These three publications must be
included.</p>
<pre><code>@inproceedings{schmidt2018,
  author    = {Uwe Schmidt and Martin Weigert and Coleman Broaddus and Gene Myers},
  title     = {Cell Detection with Star-Convex Polygons},
  booktitle = {Medical Image Computing and Computer Assisted Intervention - {MICCAI} 
  2018 - 21st International Conference, Granada, Spain, September 16-20, 2018, Proceedings, Part {II}},
  pages     = {265--273},
  year      = {2018},
  doi       = {10.1007/978-3-030-00934-2_30}
}

@inproceedings{weigert2020,
  author    = {Martin Weigert and Uwe Schmidt and Robert Haase and Ko Sugawara and Gene Myers},
  title     = {Star-convex Polyhedra for 3D Object Detection and Segmentation in Microscopy},
  booktitle = {The IEEE Winter Conference on Applications of Computer Vision (WACV)},
  month     = {March},
  year      = {2020},
  doi       = {10.1109/WACV45572.2020.9093435}
}

@inproceedings{weigert2022,
  author    = {Martin Weigert and Uwe Schmidt},
  title     = {Nuclei Instance Segmentation and Classification in Histopathology Images with Stardist},
  booktitle = {The IEEE International Symposium on Biomedical Imaging Challenges (ISBIC)},
  year      = {2022},
  doi       = {10.1109/ISBIC56247.2022.9854534}
}</code></pre>
<h1 id="installation">Installation</h1>
<h2 id="prerequisite-windows-subsystem-for-linux">Prerequisite: Windows
Subsystem for Linux</h2>
<ol type="1">
<li>Open Powershell by looking for it in the Windows Start Menu</li>
<li>Run the following command:</li>
</ol>
<pre><code>wsl --install </code></pre>
<p>Follow all instructions given, and write down both the user and root
passwords.</p>
<p>This will install the Windows-Linux compatability layer with the
recently approved Ubuntu distribution.</p>
<h3 id="wsl2-where-is-my-filesystem">WSL2: Where is my Filesystem?</h3>
<ol type="1">
<li>WSL2 creates a separate Ubuntu related file hierarchy. The Windows
C: or D: drives are located under the partition:</li>
</ol>
<pre><code>/mnt/&lt;drivename&gt;</code></pre>
<p>where all of the files associated with your Windows OS are
located.</p>
<ol start="2" type="1">
<li>To make things more convenient, you may want to symbolically link
your relevant Windows directories to corresponding Ubuntu directories.
An example is included below</li>
</ol>
<pre><code>cd ~/
ln -s ../mnt/&lt;drive&gt;/&lt;desired windows directory&gt; ./&lt;desired linux directory&gt;</code></pre>
<p>This can be confirmed by using:</p>
<pre><code>ls ./&lt;desired linux directory&gt;</code></pre>
<p>in which the contents of the corresponding Windows directory should
be shown.</p>
<figure>
<img src="/home/woodn/Pictures/linux-filesystem.png"
alt="Linux hierarchy, windows drives are symbollically linked to /mnt" />
<figcaption aria-hidden="true">Linux hierarchy, windows drives are
symbollically linked to /mnt</figcaption>
</figure>
<h2 id="prerequisite-installing-git">Prerequisite: Installing Git</h2>
<p>Git is a software version control system. It may be already installed
on Ubuntu for WSL2. To confirm this, run the command:</p>
<pre><code>git -v</code></pre>
<p>if an error is returned, you will need to install git using Ubuntu’s
software package manager, Aptitude.</p>
<pre><code>sudo apt install git</code></pre>
<p>If the command mentions ” Not in sudoers file”, this can be
circumvented by using <code>su</code> , entering the root password, then
entering the above command.</p>
<p>To add user to sudoers, while as root, enter the command</p>
<pre><code>adduser &lt;username&gt; sudo</code></pre>
<p>you may need to use <code>/sbin/adduser</code> instead.</p>
<h2 id="prerequisite-installing-python-3">Prerequisite: Installing
Python 3</h2>
<p>Python 3 is often already installed on most Linux systems. To confirm
this, enter the command</p>
<pre><code>python -V</code></pre>
<p>You will likely need to install <code>pip</code> if not already
installed:</p>
<pre><code>sudo apt install python3-pip</code></pre>
<p>If Python 3 is not installed, entering the above command will install
it as a prerequsite.</p>
<h2 id="prerequisite-install-curl">Prerequisite: Install Curl</h2>
<p>Curl is a utility that pulls down web content. To make sure curl is
installed to the system, run the following command:</p>
<pre><code>curl -V</code></pre>
<p>An output should be given, if an error is returned, run this command
to install it.</p>
<pre><code>sudo apt install curl</code></pre>
<h2 id="prerequisite-installing-miniconda-for-wsl2">Prerequisite:
Installing MiniConda for WSL2</h2>
<p>Miniconda allows packages of a specific version to be self-contained
from system-dependent python libraries. For WSL, it can be installed via
using the following commands, entered one at a time.</p>
<ol type="1">
<li>Ensure system is up to date using <code>sudo apt update</code>, then
<code>sudo apt upgrade</code></li>
<li>Return to home using <code>cd ~/</code></li>
<li>Run
<code>curl -O https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh</code></li>
<li>Output the file’s 256 bit checksum
<code>sha256sum ~/Miniconda3-latest-Linux-x86_64.sh</code></li>
<li>Check the checksum at <a
href="https://repo.anaconda.com/miniconda/">https://repo.anaconda.com/miniconda/</a></li>
<li>Execute the script
<code>bash ~/Miniconda3-latest-Linux-x86_64.sh</code>.</li>
<li>Follow the provided instructions, I would recommend keeping the
default installation prefix. It may be convenient to have conda
initialize whenever you open up WSL2 Ubunutu, if so, select yes at the
final question. If not (default option), you can always start it by
adding an alias to <code>~/.bashrc</code> by
<code>echo alias condastart="~/miniconda3/bin/conda init"</code>, doing
this will allow conda to initialize when entering
<code>condastart</code></li>
<li>Reset Bash by using <code>source ~/.bashrc</code></li>
</ol>
<p>Conda should now be installed for WSL2 Ubuntu.</p>
<h2 id="installing-stardist-for-generic-64-bit-x86-cpus">Installing
StarDist for Generic 64 Bit X86 CPUs</h2>
<p>This should work on most consumer hardware.</p>
<ol type="1">
<li>Make sure conda is initialized. The WSL Ubuntu command line should
mention <code>(base)</code> somewhere, if not run
<code>~/miniconda3/bin/conda init</code>.</li>
<li>Create conda environment using the command
<code>conda create -n stardist</code></li>
<li>Once complete, enter the conda environment using the command
<code>conda activate stardist</code></li>
<li>Once in the conda environment, install TensorFlow 2 using command
<code>conda install tensorflow</code></li>
<li>After installing tensorflow, install stardist using
<code>pip3 install stardist</code></li>
</ol>
<p>Stardist should now be installed.</p>
<h3 id="resolving-tensorflow-dependency-hell">Resolving TensorFlow
Dependency Hell</h3>
<p>If errors arise while either installing or executing stardist, you
may need to install tensorflow using <code>pip</code></p>
<ol type="1">
<li>Make sure you are in the <code>stardist</code> conda environment,
see above</li>
<li>First uninstall conda TensorFlow using
<code>conda uninstall tensorflow</code></li>
<li>Then install TensorFlow using
<code>pip3 install tensorflow</code></li>
<li>Check stardist either by installing or running the script
again.</li>
</ol>
<h2
id="installing-stardist-for-systems-with-nvidia-graphics-cards">Installing
StarDist for Systems with Nvidia Graphics Cards</h2>
<p>This is to install a StarDist version for systems that have Nvidia
graphics cards, and employs CUDA hardware acceleration.</p>
<p>To see if your Nvidia card is compatible, please check <a
href="https://developer.nvidia.com/cuda-gpus">https://developer.nvidia.com/cuda-gpus</a>.</p>
<ol type="1">
<li>Make sure conda is initialized. The WSL Ubuntu command line should
mention <code>(base)</code> somewhere, if not run
<code>~/miniconda3/bin/conda init</code>.</li>
<li>Create the required conda environment via the following conda
command:</li>
</ol>
<pre><code>conda env create -f \
https://raw.githubusercontent.com/CSBDeep/CSBDeep/main/extras/environment-gpu-py3.8-tf2.4.yml</code></pre>
<ol start="3" type="1">
<li>Enter the conda environment <code>csbdeep</code> via
<code>conda activate csbdeep</code></li>
<li>Install stardist via <code>pip install stardist</code></li>
</ol>
<p>Stardist is now installed</p>
</body>
</html>
